"use strict";(self.webpackChunkfilebridge_docs=self.webpackChunkfilebridge_docs||[]).push([[899],{4759(e,s,r){r.r(s),r.d(s,{assets:()=>l,contentTitle:()=>d,default:()=>a,frontMatter:()=>o,metadata:()=>n,toc:()=>c});const n=JSON.parse('{"id":"Hooks","title":"Hooks","description":"Hooks are reusable actions that run automatically before or after a transfer job executes. Use them to send notifications, call external APIs, or run scripts \u2014 without modifying job logic.","source":"@site/../docs/Hooks.md","sourceDirName":".","slug":"/Hooks","permalink":"/FileBridge/docs/Hooks","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{}}');var i=r(4848),t=r(8453);const o={},d="Hooks",l={},c=[{value:"How Hooks Work",id:"how-hooks-work",level:2},{value:"Hook Types",id:"hook-types",level:2},{value:"Webhook",id:"webhook",level:3},{value:"Email",id:"email",level:3},{value:"Shell Command",id:"shell-command",level:3},{value:"Template Variables",id:"template-variables",level:2},{value:"Creating a Hook",id:"creating-a-hook",level:2},{value:"Attaching Hooks to Jobs",id:"attaching-hooks-to-jobs",level:2},{value:"Viewing Hook Run Logs",id:"viewing-hook-run-logs",level:2},{value:"Enabling and Disabling Hooks",id:"enabling-and-disabling-hooks",level:2},{value:"Security",id:"security",level:2}];function h(e){const s={a:"a",blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,t.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(s.header,{children:(0,i.jsx)(s.h1,{id:"hooks",children:"Hooks"})}),"\n",(0,i.jsx)(s.p,{children:"Hooks are reusable actions that run automatically before or after a transfer job executes. Use them to send notifications, call external APIs, or run scripts \u2014 without modifying job logic."}),"\n",(0,i.jsx)(s.hr,{}),"\n",(0,i.jsx)(s.h2,{id:"how-hooks-work",children:"How Hooks Work"}),"\n",(0,i.jsx)(s.p,{children:"Each hook is a standalone, named action with a type and configuration. Hooks are attached to jobs individually and fire at the trigger point you specify."}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{children:"Job run starts\n  \u2514\u2500 Pre-job hooks fire (in order)\n       If any pre-job hook fails \u2192 job is aborted\n  \u2514\u2500 Transfer executes\n  \u2514\u2500 Post-job hooks fire (in order)\n       If any post-job hook fails \u2192 run is marked failed, but remaining hooks still fire\n"})}),"\n",(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Pre-job hooks"})," are blocking \u2014 a failure cancels the transfer before any files move."]}),"\n",(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Post-job hooks"})," are best-effort \u2014 all hooks run even if one fails, so multiple notification targets all receive the event."]}),"\n",(0,i.jsx)(s.hr,{}),"\n",(0,i.jsx)(s.h2,{id:"hook-types",children:"Hook Types"}),"\n",(0,i.jsx)(s.h3,{id:"webhook",children:"Webhook"}),"\n",(0,i.jsx)(s.p,{children:"Sends an HTTP request to any URL when a hook fires."}),"\n",(0,i.jsxs)(s.table,{children:[(0,i.jsx)(s.thead,{children:(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.th,{children:"Field"}),(0,i.jsx)(s.th,{children:"Description"})]})}),(0,i.jsxs)(s.tbody,{children:[(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:"URL"}),(0,i.jsx)(s.td,{children:"The endpoint to call"})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:"Method"}),(0,i.jsxs)(s.td,{children:[(0,i.jsx)(s.code,{children:"GET"}),", ",(0,i.jsx)(s.code,{children:"POST"}),", ",(0,i.jsx)(s.code,{children:"PUT"}),", or ",(0,i.jsx)(s.code,{children:"PATCH"})," (default: ",(0,i.jsx)(s.code,{children:"POST"}),")"]})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:"Headers"}),(0,i.jsxs)(s.td,{children:["Optional key/value pairs (e.g. ",(0,i.jsx)(s.code,{children:"Authorization: Bearer ..."}),")"]})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:"Body template"}),(0,i.jsxs)(s.td,{children:["Optional custom payload with ",(0,i.jsx)(s.a,{href:"#template-variables",children:"template variables"}),". Leave blank to use the default JSON payload"]})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:"Timeout"}),(0,i.jsx)(s.td,{children:"Maximum wait time in ms (default: 10,000)"})]})]})]}),"\n",(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Default JSON payload"})," (when no body template is set):"]}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-json",children:'{\n  "job_id": 42,\n  "job_name": "Daily CSV Export",\n  "run_id": 187,\n  "trigger": "post_job",\n  "status": "success",\n  "files_transferred": 3,\n  "bytes_transferred": 204800,\n  "error_message": null\n}\n'})}),"\n",(0,i.jsx)(s.hr,{}),"\n",(0,i.jsx)(s.h3,{id:"email",children:"Email"}),"\n",(0,i.jsx)(s.p,{children:"Sends an SMTP email when a hook fires."}),"\n",(0,i.jsxs)(s.table,{children:[(0,i.jsx)(s.thead,{children:(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.th,{children:"Field"}),(0,i.jsx)(s.th,{children:"Description"})]})}),(0,i.jsxs)(s.tbody,{children:[(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:"SMTP Host"}),(0,i.jsxs)(s.td,{children:["Your mail server hostname (e.g. ",(0,i.jsx)(s.code,{children:"smtp.gmail.com"}),", ",(0,i.jsx)(s.code,{children:"mail.company.local"}),")"]})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:"Security"}),(0,i.jsxs)(s.td,{children:[(0,i.jsx)(s.code,{children:"None (port 25)"}),", ",(0,i.jsx)(s.code,{children:"STARTTLS (port 587)"}),", or ",(0,i.jsx)(s.code,{children:"SSL / TLS (port 465)"})," \u2014 selecting a mode auto-fills the port field"]})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:"Port"}),(0,i.jsx)(s.td,{children:"Auto-filled by the Security selector; can be overridden manually"})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:"Username / Password"}),(0,i.jsx)(s.td,{children:"Leave blank for unauthenticated relays (common for internal port-25 servers)"})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:"From"}),(0,i.jsxs)(s.td,{children:["Sender address, e.g. ",(0,i.jsx)(s.code,{children:"FileBridge <noreply@company.com>"})]})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:"To"}),(0,i.jsx)(s.td,{children:"Recipient(s), comma-separated for multiple addresses"})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:"Subject"}),(0,i.jsxs)(s.td,{children:["Optional; supports ",(0,i.jsx)(s.a,{href:"#template-variables",children:"template variables"}),". Default: ",(0,i.jsx)(s.code,{children:"FileBridge \xb7 {job_name} \u2014 {status}"})]})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:"Body"}),(0,i.jsx)(s.td,{children:"Optional plain-text body; supports template variables. Default: a plain-text summary"})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:"Timeout"}),(0,i.jsx)(s.td,{children:"Maximum wait time in ms (default: 10,000)"})]})]})]}),"\n",(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Gmail / Microsoft 365 tip:"})," Use an app-specific password rather than your account password, and set Security to STARTTLS (port 587)."]}),"\n",(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Internal relay tip:"})," If your mail server accepts connections on port 25 with no authentication, set Security to ",(0,i.jsx)(s.code,{children:"None (port 25)"})," and leave Username/Password blank."]}),"\n",(0,i.jsx)(s.hr,{}),"\n",(0,i.jsx)(s.h3,{id:"shell-command",children:"Shell Command"}),"\n",(0,i.jsx)(s.p,{children:"Runs an arbitrary shell command on the FileBridge host when a hook fires."}),"\n",(0,i.jsxs)(s.table,{children:[(0,i.jsx)(s.thead,{children:(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.th,{children:"Field"}),(0,i.jsx)(s.th,{children:"Description"})]})}),(0,i.jsxs)(s.tbody,{children:[(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:"Command"}),(0,i.jsx)(s.td,{children:"Shell command or multi-line script"})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:"Working directory"}),(0,i.jsx)(s.td,{children:"Optional; defaults to the FileBridge install directory"})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:"Timeout"}),(0,i.jsx)(s.td,{children:"Maximum wait time in ms (default: 30,000)"})]})]})]}),"\n",(0,i.jsx)(s.p,{children:"Job context is passed as environment variables:"}),"\n",(0,i.jsxs)(s.table,{children:[(0,i.jsx)(s.thead,{children:(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.th,{children:"Variable"}),(0,i.jsx)(s.th,{children:"Value"})]})}),(0,i.jsxs)(s.tbody,{children:[(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:(0,i.jsx)(s.code,{children:"FILEBRIDGE_JOB_ID"})}),(0,i.jsx)(s.td,{children:"Numeric job ID"})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:(0,i.jsx)(s.code,{children:"FILEBRIDGE_JOB_NAME"})}),(0,i.jsx)(s.td,{children:"Job name string"})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:(0,i.jsx)(s.code,{children:"FILEBRIDGE_RUN_ID"})}),(0,i.jsx)(s.td,{children:"Numeric run ID"})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:(0,i.jsx)(s.code,{children:"FILEBRIDGE_TRIGGER"})}),(0,i.jsxs)(s.td,{children:[(0,i.jsx)(s.code,{children:"pre_job"})," or ",(0,i.jsx)(s.code,{children:"post_job"})]})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:(0,i.jsx)(s.code,{children:"FILEBRIDGE_STATUS"})}),(0,i.jsxs)(s.td,{children:[(0,i.jsx)(s.code,{children:"success"})," or ",(0,i.jsx)(s.code,{children:"failure"})," (empty for pre-job)"]})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:(0,i.jsx)(s.code,{children:"FILEBRIDGE_FILES_TRANSFERRED"})}),(0,i.jsx)(s.td,{children:"Count of files transferred"})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:(0,i.jsx)(s.code,{children:"FILEBRIDGE_BYTES_TRANSFERRED"})}),(0,i.jsx)(s.td,{children:"Total bytes transferred"})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:(0,i.jsx)(s.code,{children:"FILEBRIDGE_ERROR_MESSAGE"})}),(0,i.jsx)(s.td,{children:"Error message if the job failed, otherwise empty"})]})]})]}),"\n",(0,i.jsx)(s.p,{children:(0,i.jsx)(s.strong,{children:"Example \u2014 run a script:"})}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-sh",children:"bash /opt/scripts/post-transfer.sh\n"})}),"\n",(0,i.jsx)(s.p,{children:(0,i.jsx)(s.strong,{children:"Example \u2014 multi-line:"})}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-sh",children:'cd /opt/reports\npython3 generate_report.py --job "$FILEBRIDGE_JOB_NAME" --status "$FILEBRIDGE_STATUS"\n'})}),"\n",(0,i.jsxs)(s.blockquote,{children:["\n",(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Security:"})," The command runs with the same OS privileges as the FileBridge process. Restrict access to the Hooks settings page to trusted admins."]}),"\n"]}),"\n",(0,i.jsx)(s.hr,{}),"\n",(0,i.jsx)(s.h2,{id:"template-variables",children:"Template Variables"}),"\n",(0,i.jsxs)(s.p,{children:["Webhook body templates and email subject/body fields support ",(0,i.jsx)(s.code,{children:"{{variable}}"})," placeholders that are substituted at execution time:"]}),"\n",(0,i.jsxs)(s.table,{children:[(0,i.jsx)(s.thead,{children:(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.th,{children:"Variable"}),(0,i.jsx)(s.th,{children:"Example value"})]})}),(0,i.jsxs)(s.tbody,{children:[(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:(0,i.jsx)(s.code,{children:"{{job_id}}"})}),(0,i.jsx)(s.td,{children:(0,i.jsx)(s.code,{children:"42"})})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:(0,i.jsx)(s.code,{children:"{{job_name}}"})}),(0,i.jsx)(s.td,{children:(0,i.jsx)(s.code,{children:"Daily CSV Export"})})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:(0,i.jsx)(s.code,{children:"{{run_id}}"})}),(0,i.jsx)(s.td,{children:(0,i.jsx)(s.code,{children:"187"})})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:(0,i.jsx)(s.code,{children:"{{trigger}}"})}),(0,i.jsxs)(s.td,{children:[(0,i.jsx)(s.code,{children:"pre_job"})," or ",(0,i.jsx)(s.code,{children:"post_job"})]})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:(0,i.jsx)(s.code,{children:"{{status}}"})}),(0,i.jsxs)(s.td,{children:[(0,i.jsx)(s.code,{children:"success"})," or ",(0,i.jsx)(s.code,{children:"failure"})]})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:(0,i.jsx)(s.code,{children:"{{files_transferred}}"})}),(0,i.jsx)(s.td,{children:(0,i.jsx)(s.code,{children:"3"})})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:(0,i.jsx)(s.code,{children:"{{bytes_transferred}}"})}),(0,i.jsx)(s.td,{children:(0,i.jsx)(s.code,{children:"204800"})})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:(0,i.jsx)(s.code,{children:"{{error_message}}"})}),(0,i.jsx)(s.td,{children:"Error text, or empty string"})]})]})]}),"\n",(0,i.jsx)(s.hr,{}),"\n",(0,i.jsx)(s.h2,{id:"creating-a-hook",children:"Creating a Hook"}),"\n",(0,i.jsxs)(s.ol,{children:["\n",(0,i.jsxs)(s.li,{children:["Navigate to ",(0,i.jsx)(s.strong,{children:"Settings \u2192 Hooks"})]}),"\n",(0,i.jsxs)(s.li,{children:["Click ",(0,i.jsx)(s.strong,{children:"New Hook"})]}),"\n",(0,i.jsx)(s.li,{children:"Enter a name and optional description"}),"\n",(0,i.jsxs)(s.li,{children:["Select a type: ",(0,i.jsx)(s.strong,{children:"Webhook"}),", ",(0,i.jsx)(s.strong,{children:"Email"}),", or ",(0,i.jsx)(s.strong,{children:"Shell Command"})]}),"\n",(0,i.jsx)(s.li,{children:"Fill in the type-specific fields"}),"\n",(0,i.jsxs)(s.li,{children:["Toggle ",(0,i.jsx)(s.strong,{children:"Enabled"})," as needed"]}),"\n",(0,i.jsxs)(s.li,{children:["Click ",(0,i.jsx)(s.strong,{children:"Create Hook"})]}),"\n"]}),"\n",(0,i.jsx)(s.p,{children:"The hook appears in the hooks list and is now available to attach to jobs."}),"\n",(0,i.jsxs)(s.blockquote,{children:["\n",(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Tip:"})," Use the ",(0,i.jsx)(s.a,{href:"Hook-Library",children:"Hook Library"})," to import pre-built templates instead of configuring hooks from scratch."]}),"\n"]}),"\n",(0,i.jsx)(s.hr,{}),"\n",(0,i.jsx)(s.h2,{id:"attaching-hooks-to-jobs",children:"Attaching Hooks to Jobs"}),"\n",(0,i.jsx)(s.p,{children:"Hooks are attached per-job in the job form."}),"\n",(0,i.jsxs)(s.ol,{children:["\n",(0,i.jsx)(s.li,{children:"Open the job (create or edit)"}),"\n",(0,i.jsxs)(s.li,{children:["Scroll to the ",(0,i.jsx)(s.strong,{children:"Hooks"})," section"]}),"\n",(0,i.jsxs)(s.li,{children:["Select one or more hooks and choose a trigger: ",(0,i.jsx)(s.strong,{children:"Before transfer"})," (pre-job) or ",(0,i.jsx)(s.strong,{children:"After transfer"})," (post-job)"]}),"\n",(0,i.jsx)(s.li,{children:"Save the job"}),"\n"]}),"\n",(0,i.jsx)(s.p,{children:"Multiple hooks can be attached to the same trigger. They fire in the order they are listed."}),"\n",(0,i.jsx)(s.hr,{}),"\n",(0,i.jsx)(s.h2,{id:"viewing-hook-run-logs",children:"Viewing Hook Run Logs"}),"\n",(0,i.jsx)(s.p,{children:"Every hook execution is recorded. To view results:"}),"\n",(0,i.jsxs)(s.ol,{children:["\n",(0,i.jsx)(s.li,{children:"Open a job and click into a specific run"}),"\n",(0,i.jsx)(s.li,{children:"The run log table shows both file transfer entries and hook entries side by side"}),"\n",(0,i.jsx)(s.li,{children:"Hook rows show the hook name, type, trigger, status (success / failure), duration, and any output or error message"}),"\n"]}),"\n",(0,i.jsx)(s.hr,{}),"\n",(0,i.jsx)(s.h2,{id:"enabling-and-disabling-hooks",children:"Enabling and Disabling Hooks"}),"\n",(0,i.jsxs)(s.p,{children:["Hooks have a global ",(0,i.jsx)(s.strong,{children:"Enabled"})," toggle independent of job attachments. A disabled hook is silently skipped on all jobs \u2014 useful for temporarily pausing notifications without removing the hook from every job."]}),"\n",(0,i.jsx)(s.hr,{}),"\n",(0,i.jsx)(s.h2,{id:"security",children:"Security"}),"\n",(0,i.jsxs)(s.p,{children:["All hook configurations \u2014 including SMTP passwords, webhook URLs, and API keys \u2014 are encrypted at rest using AES-256-GCM. The encryption key is derived from your ",(0,i.jsx)(s.code,{children:"AUTH_SECRET"})," environment variable. Configs are decrypted in memory only when a hook executes."]}),"\n",(0,i.jsxs)(s.p,{children:["Rotating ",(0,i.jsx)(s.code,{children:"AUTH_SECRET"})," will invalidate all stored hook configurations; re-enter them after any key rotation."]})]})}function a(e={}){const{wrapper:s}={...(0,t.R)(),...e.components};return s?(0,i.jsx)(s,{...e,children:(0,i.jsx)(h,{...e})}):h(e)}},8453(e,s,r){r.d(s,{R:()=>o,x:()=>d});var n=r(6540);const i={},t=n.createContext(i);function o(e){const s=n.useContext(t);return n.useMemo(function(){return"function"==typeof e?e(s):{...s,...e}},[s,e])}function d(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:o(e.components),n.createElement(t.Provider,{value:s},e.children)}}}]);