name: Microsoft Teams Notification
description: >
  Sends a message card to a Microsoft Teams channel when a job completes.
  Requires a Teams Incoming Webhook URL set via the TEAMS_WEBHOOK_URL environment variable.
type: webhook
tags:
  - teams
  - microsoft
  - notification
  - messaging
author: FileBridge Community
config:
  url: "{{TEAMS_WEBHOOK_URL}}"
  method: POST
  headers:
    Content-Type: application/json
  body: '{"@type": "MessageCard", "@context": "http://schema.org/extensions", "summary": "FileBridge Job Complete", "sections": [{"activityTitle": "FileBridge · {{job_name}}", "activitySubtitle": "{{files_transferred}} file(s) transferred · trigger: {{trigger}}"}]}'
  timeoutMs: 5000
